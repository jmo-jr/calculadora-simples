<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="Set-Cookie" content="HttpOnly;Secure;SameSite=Strict">
  <title>Ellun Contabilidade | Calculadora Tributária</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
  <style>
    h1 {
      font-size: 24px;
    }
    button {
      margin-bottom: 20px;
    }
    .inline-input {
      display: inline-flex;
      width: 72%;
      justify-content: space-between;
      align-items: flex-start;
    }
    #proLab5 { width: auto; }
  </style>
</head>

<body>

  <div class="container">

    <h1 class="mt-3 mb-3">Calculadora Simples Nacional</h1>

    <!-- NAVIGATION TABS -->
    <ul class="nav nav-tabs" id="myTab" role="tablist">
      <li class="nav-item">
        <a class="nav-link active" id="home-tab" data-toggle="tab" href="#home" role="tab" aria-controls="home" aria-selected="true">Anexo III</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" id="anexo-tab" data-toggle="tab" href="#anexo" role="tab" aria-controls="anexo" aria-selected="false">Anexo V</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" id="lucro-tab" data-toggle="tab" href="#lucro" role="tab" aria-controls="lucro" aria-selected="false">Lucro Presumido</a>
      </li>
    </ul>

    <!-- TABS  CONTENT -->
    <div class="tab-content mt-3 mb-3" id="myTabContent">

      <!-- ANEXO III -->
      <div class="tab-pane fade show active" id="home" role="tabpanel" aria-labelledby="home-tab">

        <div class="container">

          <!-- RECEBIMENTOS NO BRASIL -->
          <div class="row">

            <!-- COL 1 -->
            <div class="col-2">
              <div class="form-group">
                <label for="rbt12">RBT12 (R$)</label>
                <input type="tel" id="rbt123" name="rbt12" class="form-control">
              </div>
            </div>

            <!-- COL 2 -->
            <div class="col-2">
              <div class="form-group">
                <label for="receita">Receita mensal (R$)</label>
                <input type="tel" id="receita" name="receita" class="form-control">
              </div>
            </div>

            <!-- COL 4 -->
            <div class="col-2">
              <div class="form-group">
                <label for="dasbr">DAS BR (R$)</label>
                <input type="tel" id="dasbr" name="dasbr" class="form-control" disabled>
              </div>
            </div>

          </div>

          <!-- RECEBIMENTOS NO EXTERIOR -->
          <div class="row">

            <!-- COL 1 -->
            <div class="col-2">
              <div class="form-group">
                <label for="rbt12Ext">RBT12 Exterior</label>
                <input type="tel" id="rbt123Ext" name="rbt12Ext" class="form-control">
              </div>
            </div>

            <!-- COL 2 -->
            <div class="col-2">
              <div class="form-group">
                <label for="receitaExt">Receita mensal Ext</label>
                <input type="tel" id="receitaExt" name="receitaExt" class="form-control">
              </div>
            </div>

            <!-- COL 4 -->
            <div class="col-2">
              <div class="form-group">
                <label for="dasext">DAS Ext (R$)</label>
                <input type="tel" id="dasext" name="dasext" class="form-control" disabled>
              </div>
            </div>
          </div>

          <div class="row">
            <!-- Nº DEPENDENTES -->
            <div class="col-2">
              <div class="form-group">
                <label for="receita">Nº de dependentes</label>
                <input type="number" id="dependentes" name="dependentes" class="form-control" min="0" max="10">
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col">
              <button type="button" id="btn-three" class="btn btn-primary">Calcular</button>
            </div>
          </div>

        </div>

        <div class="container">
          <div class="row">
            <div class="col">

              <!-- Resultado BR -->
              <table id="results" class="table table-bordered text-center">
                <thead>
                  <tr>
                    <th rowspan="2" class="align-middle">Alíquota efetiva BR</th>
                    <th colspan="6">Percentuais Efetivos dos Tributos BR</th>
                  </tr>
                  <tr>
                    <th>IRPJ</th>
                    <th>CSLL</th>
                    <th>Cofins</th>
                    <th>PIS/PASEP</th>
                    <th>CPP</th>
                    <th>ISS</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><span id="af">0</span></td>
                    <td><span id="irpj">0</span></td>
                    <td><span id="csll">0</span></td>
                    <td><span id="cofins">0</span></td>
                    <td><span id="pis">0</span></td>
                    <td><span id="cpp">0</span></td>
                    <td><span id="iss">0</span></td>
                  </tr>
                </tbody>
              </table>

              <!-- Resultado Ext -->
              <table id="results-ext" class="table table-bordered text-center">
                <thead>
                  <tr>
                    <th rowspan="2" class="align-middle">Alíquota efetiva Ext</th>
                    <th colspan="6">Percentuais Efetivos dos Tributos Ext</th>
                  </tr>
                  <tr>
                    <th>IRPJ</th>
                    <th>CSLL</th>
                    <th>Cofins</th>
                    <th>PIS/PASEP</th>
                    <th>CPP</th>
                    <th>ISS</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><span id="af-ext">0</span></td>
                    <td><span id="irpj-ext">0</span></td>
                    <td><span id="csll-ext">0</span></td>
                    <td><span id="cofins-ext">0</span></td>
                    <td><span id="pis-ext">0</span></td>
                    <td><span id="cpp-ext">0</span></td>
                    <td><span id="iss-ext">0</span></td>
                  </tr>
                </tbody>
              </table>

            </div>
          </div>

          <!-- TABELA FATOR R -->
          <div class="row">
            <div class="col">

              <table id="fatoR" class="table table-bordered text-center">
                <thead>
                  <tr>
                    <th>
                      Fator R &nbsp;
                      <select name="percentFR" id="percentFR" class="form-control d-inline" style="width: 80px">
                        <option value="0.28" selected>28%</option>
                        <option value="0.3">30%</option>
                      </select>
                    </th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td id="valorFR"></td>
                  </tr>
                </tbody>
              </table>

            </div>
          </div>

          <!-- TABELA PRO LABORE -->
          <div class="row">
            <div class="col">

              <table id="proLabore" class="table table-bordered">
                <tbody>
                  <tr>
                    <td><strong>Pro-Labore</strong></td>
                    <td id="proLab">0</td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><strong>INSS 11%</strong></td>
                    <td id="inss">0</td>
                    <td>Vencimento dia 20 do mês subsequente</td>
                  </tr>
                  <tr>
                    <td id="aliquotaIr"><strong>IR</strong></td>
                    <td id="ir">0</td>
                    <td>Vencimento dia 20 do mês subsequente</td>
                  </tr>
                  <tr>
                    <td><strong>Pro-Labore Líquido</strong></td>
                    <td id="proLabLiquid">0</td>
                    <td>Transferir no último dia do mês</td>
                  </tr>
                </tbody>
              </table>

            </div>
          </div>

          <h4>Total de Impostos Mensais</h4>
          <p><strong>Prestadores de Serviços para Empresas Brasileiras: </strong><span id="psbr"></span></p> 
          <p><strong>Prestadores de Serviços para Empresas Estrangeiras: </strong><span id="psext"></span></p>

          <h4>Quadro de Despesas</h4>
          <p>
            <strong>Acessoria contábil: </strong><input type="tel" id="acessoria" name="acessoria" class="form-control d-inline" style="width:150px">
          </p>
          <p>
            <strong>Outras despesas: </strong><input type="tel" id="outras" name="outras" class="form-control d-inline" style="width:150px">
          </p>
          <button type="button" id="btnUpdLl" class="btn btn-primary">Atualizar</button>
          
          <p><strong>Lucro líquido: </strong><span id="lucroLiquido"></span></p>

        </div>

      </div>

      <!-- ANEXO V -->
      <div class="tab-pane fade" id="anexo" role="tabpanel" aria-labelledby="anexo-tab">
        
        <div class="container">
          <div class="row">

            <!-- COL ! -->
            <div class="col-3">
              <div class="form-group">
                <label for="rbt125">Seu RBT12</label>
                <input type="tel" id="rbt125" name="rbt125" class="form-control">
              </div>
            </div>

            <!-- COL 2 -->
            <div class="col-3">
              <div class="form-group">
                <label for="receita5">Receita mensal</label>
                <input type="tel" id="receita5" name="receita" class="form-control">
              </div>
            </div>

            <!-- COL 3 -->
            <div class="col-3">
              <div class="form-group">
                <label for="dasbr5">DAS BR</label>
                <input type="tel" id="dasbr5" name="dasbr" class="form-control" disabled>
              </div>
            </div>

            <!-- COL 4 -->
            <div class="col-3">
              <div class="form-group">
                <label for="dasext5">DAS EX</label>
                <input type="tel" id="dasext5" name="dasext" class="form-control" disabled>
              </div>
            </div>

          </div>

          <div class="row">
            <div class="col">
              <button type="button" id="btn-five" class="btn btn-primary">Calcular</button>
            </div>
          </div>
        </div>

        <div class="container">
          <div class="row">
            <div class="col">

              <table id="results" class="table table-bordered text-center">
                <thead>
                  <tr>
                    <th rowspan="2" class="align-middle">Alíquota efetiva</th>
                    <th colspan="6">Percentuais Efetivos dos Tributos</th>
                  </tr>
                  <tr>
                    <th>IRPJ</th>
                    <th>CSLL</th>
                    <th>Cofins</th>
                    <th>PIS/PASEP</th>
                    <th>CPP</th>
                    <th>ISS</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><span id="af5">0</span></td>
                    <td><span id="irpj5">0</span></td>
                    <td><span id="csll5">0</span></td>
                    <td><span id="cofins5">0</span></td>
                    <td><span id="pis5">0</span></td>
                    <td><span id="cpp5">0</span></td>
                    <td><span id="iss5">0</span></td>
                  </tr>
                </tbody>
              </table>

            </div>
          </div>

          <!-- TABELA PRO LABORE -->
          <div class="row">
            <div class="col">

              <table id="proLabore" class="table table-bordered">
                <tbody>
                  <tr>
                    <td><strong>Pro-Labore</strong></td>
                    <td>R$ 
                      <div class="inline-input">
                        <input type="tel" id="proLab5" name="rbt12" class="form-control">
                        <button type="button" id="recalcular" class="btn btn-primary">Recalcular</button>
                      </div>
                    </td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><strong>INSS 11%</strong></td>
                    <td id="inss5">0</td>
                    <td>Vencimento dia 20 do mês subsequente</td>
                  </tr>
                  <tr>
                    <td id="aliquotaIr5"><strong>IR</strong></td>
                    <td id="ir5">0</td>
                    <td>Vencimento dia 20 do mês subsequente</td>
                  </tr>
                  <tr>
                    <td><strong>Pro-Labore Líquido</strong></td>
                    <td id="proLabLiquid5">0</td>
                    <td>Transferir no último dia do mês</td>
                  </tr>
                </tbody>
              </table>

            </div>
          </div>

          <h4>Total de Impostos Mensais</h4>
          <p><strong>Prestadores de Serviços para Empresas Brasileiras: </strong><span id="psbr5"></span></p> 
          <p><strong>Prestadores de Serviços para Empresas Estrangeiras: </strong><span id="psext5"></span></p>

        </div>

      </div>

      <!-- LUCRO PRESUMIDO -->
      <div class="tab-pane fade" id="lucro" role="tabpanel" aria-labelledby="lucro-tab">
        
        <div class="container">
          <div class="row">

            <!-- Receita -->
            <div class="col-3">
              <div class="form-group">
                <label for="salario">Receita Mensal</label>
                <input type="tel" id="salario" class="form-control">
              </div>
            </div>

            <!-- ISS -->
            <div class="col-3">
              <div class="form-group">
                <label for="issSelect">ISS</label>
                <select id="issSelect" class="form-control">
                  <option>Escolha a alíquota</option>
                  <option value="0.02">2%</option>
                  <option value="0.05">5%</option>
                </select>
              </div>
            </div>

          </div>

          <div class="row">
            <div class="col">
              <button type="button" id="btn-lucro" class="btn btn-primary">Calcular</button>
            </div>
          </div>
        </div>

        <div class="container">
          <div class="row">
            <div class="col">

              <table id="presumido" class="table table-bordered text-center">
                <thead>
                  <tr>
                    <th colspan="5">Lucro Presumido</th>
                  </tr>
                  <tr>
                    <th>PIS</th>
                    <th>Cofins</th>
                    <th>ISS</th>
                    <th>IRPJ</th>
                    <th>CSLL</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th>0,65%</th>
                    <th>3,00%</th>
                    <th id="issSelected">Escolha</th>
                    <th>4,80%</th>
                    <th>2,88%</th>
                  </tr>
                  <tr>
                    <td><span id="pisLucro">0</span></td>
                    <td><span id="cofinsLucro">0</span></td>
                    <td><span id="issLucro">0</span></td>
                    <td><span id="irpjLucro">0</span></td>
                    <td><span id="csllLucro">0</span></td>
                  </tr>
                </tbody>
              </table>

            </div>
          </div>

          <!-- IRPJ -->
          <div class="row">
            <div class="col">

              <table id="irpjAdicional" class="table table-bordered" style="width:60%">
                <tbody>
                  <tr>
                    <td><strong>IRPJ ADC (10%)</strong></td>
                    <td>Base 32%</td>
                    <td id="irpjAdc">R$ 0</td>
                  </tr>
                </tbody>
              </table>

            </div>
          </div>

          <!-- TABELA PRO LABORE LP -->
          <div class="row">
            <div class="col">

              <table id="proLaboreLp" class="table table-bordered">
                <tbody>
                  <tr>
                    <td><strong>Pro-Labore</strong></td>
                    <td>R$ 
                      <div class="inline-input">
                        <input type="tel" id="proLabLp" name="proLabLp" class="form-control">
                        <button type="button" id="recalcularLp" class="btn btn-primary">Recalcular</button>
                      </div>
                    </td>
                  </tr>
                  <tr>
                    <td><strong>INSS 11%</strong></td>
                    <td id="inssLp">0</td>
                    <td>Vencimento dia 20 do mês subsequente</td>
                  </tr>
                  <tr>
                    <td><strong>INSS PJ 20%</strong></td>
                    <td><span id="inssPjLp">0</span></td>
                    <td>Vencimento dia 20 do mês subsequente</td>
                  </tr>
                  <tr>
                    <td id="aliquotaIrLp"><strong>IR</strong></td>
                    <td id="irLp">0</td>
                    <td>Vencimento dia 20 do mês subsequente</td>
                  </tr>
                  <tr>
                    <td><strong>Pro-Labore Líquido</strong></td>
                    <td id="proLabLiquidoLp">0</td>
                    <td>Transferir no último dia do mês</td>
                  </tr>
                </tbody>
              </table>

            </div>
          </div>

          <h4>Imposto Mensal a Pagar</h4>
          <p><strong>Impostos a Pagar BR: </strong><span id="psbrLucro"></span></p> 
          <p><strong>Impostos a Pagar EX: </strong><span id="psextLucro"></span></p>

        </div>

      </div>

    </div>

  </div>
  
  <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.mask/1.14.16/jquery.mask.min.js" integrity="sha512-pHVGpX7F/27yZ0ISY+VVjyULApbDlD0/X0rgGbTqCE7WFW5MezNTWG/dnhtbBuICzsd0WQPgpE4REBLv+UqChw==" crossorigin="anonymous"></script>
  <script src="simples_functions.js"></script>
  
  <!-- SCRIPTS ANEXO III -->
  <script>
    $(document).ready( function() {

      $('#btn-three').click( function() {

        var rbtBr = 0;
        var receita_mensal = 0;
        var rbtExt = 0;
        var rbtExt = 0;
        var deps = 0;
        var res3 = [];

        rbtBr = $('#rbt123').val();
        receita_mensal = $('#receita').val();
        rbtExt = $('#rbt123').val();
        receitaExt = $('#receitaExt').val();
        deps = $('#dependentes').val();

        var res3 = snthree(rbtBr);
        var res3Ext = snthree(rbtExt);

        $("#af").html(res3[0] + "%");
        $("#irpj").html(res3[1] + "%");
        $("#csll").html(res3[2] + "%");
        $("#cofins").html(res3[3] + "%");
        $("#pis").html(res3[4] + "%");
        $("#cpp").html(res3[5] + "%");
        $("#iss").html(res3[6] + "%");

        $("#irpj-ext").html(res3Ext[1] + "%");
        $("#csll-ext").html(res3Ext[2] + "%");
        $("#cpp-ext").html(res3Ext[5] + "%");

        /*** NOVO ***/

        var aliquota_efetiva = res3[0];
        var dasBr = receita_mensal * (aliquota_efetiva/100);
        
        var aliquota_ext = Number(res3Ext[1]) + Number(res3Ext[2]) + Number(res3Ext[5]);
        var dasExt = receitaExt * (aliquota_ext/100);

        $("#af-ext").html(aliquota_ext + "%");

        var percentR = $('#percentFR').val();
        var porcentagem = Number(percentR);

        var proLab = proLaboreR(receita_mensal, aliquota_efetiva, porcentagem);
        var proLabExt = proLaboreR(receitaExt, aliquota_ext, porcentagem);

        //0:fatorR, 1:inssBase, 2:inss, 3:irBase, 4:ir, 5:valorIR

        $('#dasbr').val(dasBr).mask("R$ ###.##0,00");
        $('#dasext').val(dasExt).mask("R$ ###.##0,00");

        // var valorFR = Math.round10(proLab[0], -4);
        var valorFR = proLab[0];
        $('#valorFR').html(valorFR).mask("R$ #.##0,00");
        $('#proLab').html(valorFR).mask("R$ #.##0,00");

        // var valorInss = Math.round10(proLab[2], -4);
        var valorInss = proLab[2];
        $('#inss').text(valorInss).mask("R$ 000,00");
        
        $('#aliquotaIr').html('<strong>IR ' + proLab[4] * 100 + '%</strong>');

        var depValue = 189.59;
        var totalIr = 0;
        deps > 0 ? totalIr = proLab[5] - (deps * depValue) : totalIr = proLab[5]
        $('#ir').html(totalIr).mask("R$ #.##0,00");

        var proLaboreLiquido = proLab[3] - proLab[5];
        // proLaboreLiquido = Math.round10(proLaboreLiquido, -2);
        $('#proLabLiquid').html(proLaboreLiquido).mask("R$ #.##0,00");

        var psBr = dasBr + proLab[2] + proLab[5];
        //psBr = Math.round10(psBr, -4);
        $('#psbr').text(psBr).mask("R$ #.##0,00");

        var psExt = dasExt + proLabExt[2] + proLabExt[5];
        //psExt = Math.round10(psExt, -4);
        $('#psext').text(psExt).mask("R$ #.##0,00");

      });

      /*
       * Função para cálculo do Lucro Líquido
       *
       * Lucro Líquido = Receita Mensal - Impostos Mensais (variando entre DAS BR e DAS EX) 
       * - Assessoria Contábil - Outras Despesas
       */

      $('#btnUpdLl').click( function() {
        var receita = $('#receita').val();
        var dasBr = $('#dasbr').cleanVal();
        var dasExt = $('#dasext').cleanVal();
        var dasExtVal = 0;
        dasExt > 0 ? dasExtVal = dasExt : dasExtVal = 0;
        var asseCont = $('#acessoria').val();
        var outrasDesps = $('#outras').val();

        var lucroLiquido = receita - dasBr - dasExtVal - asseCont - outrasDesps;

        $('#lucroLiquido').text(lucroLiquido).mask("R$ #.##0,00");

        console.log(receita, dasBr, dasExt, asseCont, outrasDesps)
      });

    });
  </script>
  
  <!-- SCRIPTS ANEXO V -->
  <script>
    $(document).ready( function() {

      $('#btn-five').click( function() {

        var value = $('#rbt125').val();

        var res5 = snfive(value);

        $("#af5").html(res5[0] + "%");
        $("#irpj5").html(res5[1] + "%");
        $("#csll5").html(res5[2] + "%");
        $("#cofins5").html(res5[3] + "%");
        $("#pis5").html(res5[4] + "%");
        $("#cpp5").html(res5[5] + "%");
        $("#iss5").html(res5[6] + "%");

        /*** NOVO ***/

        var receita_mensal = $('#receita5').val();
        var aliquota_efetiva = res5[0];

        var dasBr = receita_mensal * (aliquota_efetiva/100);

        var aliquota_ext = Number(res5[1]) + Number(res5[2]) + Number(res5[5]);
        var dasExt = receita_mensal * (aliquota_ext/100);

        var proLab = proLaboreR(receita_mensal, aliquota_efetiva);
        // proLab = [0;fatorR, 1:inssBase, 2:inss, 3:irBase, 4:ir, 5:valorIR]

        $('#dasbr5').val(dasBr);
        $('#dasext5').val(dasExt);

        /*
         * TABELA PRO LABORE 
         */

        var salario = Math.round10(proLab[0], -4);
        $('#proLab5').val(salario);

        // Se valor for alterado, usa esse
        var proLab5 = $('#proLab5').val();

        /* Cálculo INSS */

        //var valorInss = Math.round10(proLab[2], -4);
        $('#inss5').text(proLab[2]).mask("R$ #.##0,00");

        /* Calculo IR */
        var percentIR = Math.round10(proLab[4], -4);
        $('#aliquotaIr5').html('<strong>IR ' + percentIR * 100 + '%</strong>');

        var totalIr = proLab[5];
        //totalIr = Math.round10(totalIr, -4);
        $('#ir5').html('R$ ' + totalIr).mask("R$ #.##0,00");

        /* PL Liquido */

        var proLaboreLiquido = proLab[3] - proLab[5];
        proLaboreLiquido = Math.round10(proLaboreLiquido, -4);
        $('#proLabLiquid5').html('R$ ' + proLaboreLiquido);

        /*** IMPOSTOS MENSAIS ***/

        var psBr = dasBr + proLab[2] + proLab[5];
        //psBr = Math.round10(psBr, -4);
        $('#psbr5').text('R$ ' + psBr).mask("R$ #.##0,00");

        var psExt = dasExt + proLab[2] + proLab[5];
        //psExt = Math.round10(psExt, -4);
        $('#psext5').text('R$ ' + psExt).mask("R$ #.##0,00");
        
      });

      /**
       * Recálculo do IR e INSS ao alterar o valor do Pro-Labore
       **/

      $('#recalcular').click(function() {
        // Se valor for alterado, usa esse
        var proLab5 = $('#proLab5').val();

        /*** Cálculo INSS ***/

        var inssBase = proLab5 * 0.11;
        var inss = 0;

        if (inssBase <= 707.70) {
          inss = inssBase;
        } else {
          inss = 707.70;
        }

        var valorInss = Math.round10(inss, -4);
        $('#inss5').text('R$ ' + valorInss);

        /*** Cálculo IR ***/

        var irBase = proLab5 - inss;
        let ir = 0;
        let reduzir = null;

        if (irBase <= 1903.98) {
          ir = 0;
          reduzir = 0;
        }
        if (irBase >= 1903.98 && irBase <= 2826.65) {
          ir = 0.075;
          reduzir = 142.80;
        }
        if (irBase >= 2826.66 && irBase <= 3751.05) {
          ir = 0.15;
          reduzir = 354.80;
        }
        if (irBase >= 3751.06 && irBase <= 4664.68) {
          ir = 0.2250;
          reduzir = 636.13;
        }
        if (irBase > 4664.68) {
          ir = 0.2750;
          reduzir = 869.36;
        }

        var valorIR = (irBase * ir) - reduzir;

        $('#aliquotaIr5').html('<strong>IR ' + ir * 100 + '%</strong>');

        var totalIr = valorIR;
        totalIr = Math.round10(totalIr, -4);
        $('#ir5').html('R$ ' + totalIr);

        /*** PL Liquido ***/

        var proLaboreLiquido = irBase - valorIR;
        proLaboreLiquido = Math.round10(proLaboreLiquido, -4);
        $('#proLabLiquid5').html('R$ ' + proLaboreLiquido);

        /*** IMPOSTOS MENSAIS ***/

        var receita_mensal = $('#receita5').val();
        var fatorR = receita_mensal * 0.28;

        var aliquota_efetiva = parseFloat($("#af5").html());
        var irpj = parseFloat($("#irpj5").html());
        var csll = parseFloat($("#csll5").html());
        var cpp = parseFloat($("#cpp5").html());
        
        var dasBr = receita_mensal * (aliquota_efetiva/100);

        var aliquota_ext = Number(irpj) + Number(csll) + Number(cpp);
        var dasExt = receita_mensal * (aliquota_ext/100);

        var psBr = dasBr + inss + valorIR;
        psBr = Math.round10(psBr, -4);
        $('#psbr5').text('R$ ' + psBr);

        var psExt = dasExt + inss + valorIR;
        psExt = Math.round10(psExt, -4);
        $('#psext5').text('R$ ' + psExt);
      })
    });
  </script>
  
  <!-- SCRIPTS LUCRO -->
  <script>
    $(document).ready( function() {
      $('#btn-lucro').click( function() {

        var salario = $('#salario').val();
        var aliquota_iss = $('#issSelect').val();

        var result = lucroPresumido(salario, aliquota_iss);

        $("#pisLucro").html('R$ ' + result[0]);
        $("#cofinsLucro").html('R$ ' + result[1]);
        $("#issLucro").html('R$ ' + result[2]);
        $("#irpjLucro").html('R$ ' + result[3]);
        $("#csllLucro").html('R$ ' + result[4]);

        $("#issSelected").html((aliquota_iss * 100) + "%");
        
        $("#irpjAdc").html('R$ ' + result[5]);

        var irTotal = result.reduce((a, b) => a + b, 0);

        /*
         * TABELA PRO LABORE LP
         */

        var proLab = proLaboreR(salario, aliquota_iss);

        /*** Campo Pro-Labore ***/
        //var valorProLabore = Math.round10(proLab[0], -4);
        var valorProLabore = proLab[0].toFixed(2);
        $('#proLabLp').val(valorProLabore).mask("##.##0,00", {reverse: true});

        /*** Linha INSS ***/
        var valorInss = maskValue(proLab[2]);
        $('#inssLp').text(valorInss);

        /*** Linha INSS PJ ***/
        var valorInssPj = valorProLabore * 0.2;
        //var inssPj = valorInssPj.toFixed(2);
        var inssPj = maskValue(valorInssPj);

        $('#inssPjLp').text(inssPj);

        /*** Linha IR ***/

        /* Porcentagem IR */
        var percentIR = Math.round10(proLab[4], -4);
        $('#aliquotaIrLp').html('<strong>IR ' + percentIR * 100 + '%</strong>');

        /* Valor IR */
        var totalIr = proLab[5];
        $('#irLp').html(totalIr).mask("R$ #.##0,00");

        /*** Linha Pro-Labore Líquido ***/
        var proLaboreLiquido = proLab[3] - proLab[5];
        //proLaboreLiquido = Math.round10(proLaboreLiquido, -4);
        $('#proLabLiquidoLp').html(proLaboreLiquido).mask("R$ #.##0,00");

        /* 
         * IMPOSTO MENSAL A PAGAR
         *
         * Imposto a Pagar BR (Considerar todos os Impostos + IRPJ Adc)
         * Imposto a Pagar EX (Que vai considerar somente IRPJ, CSLL e IRPJ Adc)
         */

        $("#psbrLucro").html((irTotal + result[5])).mask("R$ #.##0,00");
        $("#psextLucro").html((result[3] + result[4] + result[5])).mask("R$ #.##0,00");

      });

      /***************************************
       *
       * RECALCULAR PRO-LABORE LUCRO PRESUMIDO
       * 
       ***************************************/

      $('#recalcularLp').click( function() {

        // Se valor for alterado, usa esse
        var proLabLp = $('#proLabLp').val();
        var salario = $('#salario').val();
        var aliquota_iss = $('#issSelect').val();

        var proLab = proLaboreR(salario, aliquota_iss);

        /*** Cálculo INSS ***/

        var inssBase = proLabLp * 0.11;
        var inss = 0;

        if (inssBase <= 707.70) {
          inss = inssBase;
        } else {
          inss = 707.70;
        }

        /*** Cálculo INSS ***/
        $('#inssLp').text(inss).mask("R$ #.##0,00");

        /*** Cálculo INSS PJ ***/
        var inssPj = proLabLp * 0.2;
        $('#inssPjLp').text(inssPj).mask("R$ #.##0,00");

        /*** Cálculo IR ***/
        /* Porcentagem IR */
        var percentIR = Math.round10(proLab[4], -4);
        $('#aliquotaIr5').html('<strong>IR ' + percentIR * 100 + '%</strong>');
        /* Valor IR */
        var totalIr = proLab[5];
        $('#ir5').html(totalIr).mask("R$ #.##0,00");

        /*** Pro-Labora Líquido ***/
        var proLaboreLiquido = proLab[3] - proLab[5];
        $('#proLabLiquid5').html(proLaboreLiquido).mask("R$ #.##0,00");

        /*** IMPOSTOS MENSAIS ***/

        var salario = $('#salario').val();
        var aliquota_iss = $('#issSelect').val();

        var lpResult = lucroPresumido(salario, aliquota_iss);

        $("#psbrLucro").html((totalIr + inssPj + lpResult[5])).mask("R$ #.##0,00");
        $("#psextLucro").html((lpResult[3] + lpResult[4] + lpResult[5])).mask("R$ #.##0,00");

        console.log('INSS:'+inss, 'INSSPJ:'+inssPj, 'IR%:'+percentIR, 'IR:'+totalIr, 'PROLAB:'+proLaboreLiquido, 'SAL:'+salario, 'ISS:'+aliquota_iss);

        console.log();
      })
    });
  </script>

</body>
</html>